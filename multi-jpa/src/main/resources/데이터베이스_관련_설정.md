# 데이터 베이스 관련 설정

## `spring.datasource.hikari`

Spring Boot에서 기본적으로 사용하는 데이터베이스 커넥션 풀 라이브러리

1. `minimum-idle`

> 애플리케이션의 트래픽 패턴과 데이터베이스의 처리 용량에 따라 조정해야 한다. 
> 일반적으로 최대 연결 수는 데이터베이스 서버의 성능에 맞춰 설정하고, 
> 최소 유휴 연결 수는 애플리케이션의 기본 트래픽을 감당할 수 있는 수준으로 설정해야 한다.
> </br> </br>
> <예시> </br>
> 1. 높은 트래픽을 처리하고, 데이터베이스에 자주 접근하는 경우 높게 설정하여 연결 생성지연을 최소화
> 2. 트래픽 변동이 큰 경우, 평균적인 유휴 연결 수를 고려하여 설정 

- 풀에서 유지할 최소 유휴 연결 수를 지정
- 이 설정 값보다 유휴 연결 수가 적어지면 풀은 새로운 연결을 생성하여 최소 유휴 연결 수를 유지
- **기본값** : 10


2. `maximum-pool-size`

> 애플리케이션의 트래픽 패턴과 데이터베이스의 처리 용량에 따라 조정해야 한다.
> 일반적으로 최대 연결 수는 데이터베이스 서버의 성능에 맞춰 설정하고,
> 최소 유휴 연결 수는 애플리케이션의 기본 트래픽을 감당할 수 있는 수준으로 설정해야 한다.
> </br> </br>
> <예시> </br>
> 1. 높은 트래픽을 처리하고, 데이터베이스에 자주 접근하는 경우 높게 설정하여 많은 동시 연결을 허용
> 2. 트래픽 변동이 큰 경우, 최대 트래픽을 처리할 수 있도록 값을 높게 설정하여 트래픽이 급증할 때도 충분한 연결을 제공하여 성능 저하를 방지


- 풀에서 관리할 최대 연결 수를 지정
- 이 값은 동시에 사용할 수 있는 최대 연결 수를 의미
- **기본값** : 10


3. `idle-timeout`

> 너무 짧게 설정하면 불필요한 연결 생성과 소멸이 빈번하게 일어나고, 
> 너무 길게 설정하면 유휴 연결이 너무 많이 유지되어 자원 낭비가 발생할 수 있다
> </br> </br>
> <예시> </br>
> 1. 높은 유휴 시간 설정 시 커넥션이 더 오래 유지되므로 재사용이 가능해져 성능을 향상 시킬 수 있지만, 사용되지 않는 커넥션이 오래 유지되면 리소스 낭비가 된다.

- 유휴 연결이 풀에서 제거되기 전에 유휴 상태로 유지되는 최대 시간(밀리초)
- 이 값은 minimum-idle 설정에 영향을 받는다.
- 유휴 연결이 지정된 시간 동안 사용되지 않으면 제거
- **기본값** : 600000 (10분)


4. `max-lifetime`

> 데이터베이스 서버나 네트워크 인프라에서 설정한 연결 제한 시간보다 약간 짧게 설정하여 연결이 비정상적으로 끊어지지 않도록 한다.
> </br> </br>
> <예시> </br>
> 1. 생명 주기가 짧으면: 커넥션이 자주 갱신되어 잠재적 문제를 줄이지만, 커넥션 생성/제거 오버헤드가 발생할 수 있다.
> 2. 생명 주기가 길면: 커넥션 생성/제거 오버헤드가 줄어들지만, 오래된 커넥션이 풀에 남아있어 문제를 발생시킬 수 있다

- 연결이 풀에서 제거되기 전까지의 최대 생명 주기(밀리초)
- 일반적으로 데이터베이스 또는 인프라 수준에서 설정된 연결 제한 시간보다 조금 짧게 설정해야 한다.
- **기본값** : 1800000 (30분)


5. `connection-timeout`

> 연결을 얻기 위해 기다릴 수 있는 최대 시간을 설정한다.
> 너무 짧게 설정하면 일시적인 부하에서도 예외가 발생할 수 있고, 
> 너무 길게 설정하면 응답 속도가 느려질 수 있다.
> <예시> </br>
> 1. 타임아웃이 짧으면: 시스템 응답성이 높아지지만, 부하가 높은 상황에서 예외가 많이 발생할 수 있다.
> 2. 타임아웃이 길면: 부하가 높은 상황에서 예외 발생을 줄일 수 있지만, 응답 시간이 길어질 수 있다.

- 연결을 시도할 때의 최대 대기 시간(밀리초)
- 이 시간 내에 연결을 얻지 못하면 예외가 발생
- **기본값** : 30000 (30초)


6. `validation-timeout`

> 연결 유효성 검사에 필요한 시간을 충분히 확보하지만, 
> 너무 길게 설정하여 응답 시간을 늘리지 않도록 주의한다.
> <예시> </br>
> 일반적으로 커넥션을 풀에서 가져오고 반환할 때마다 유효성 검사가 수행된다.
> 이 설정은 유효성 검사를 수행하는 시간을 제한하며, 시간이 초과되면 유효성 검사에 실패한 것으로 간주될 수 있다.

- 연결 유효성 검사가 완료되기까지 기다리는 최대 시간(밀리초)
- **기본값** : 5000 (5초)


7. `leak-detection-threshold`

> 개발 및 테스트 환경에서 연결 누출을 감지하기 위해 설정할 수 있으며, 
> 운영 환경에서는 성능에 미치는 영향을 고려하여 사용한다.

- 연결 누출을 감지하기 위한 임계값(밀리초)
- 이 시간 동안 연결이 반환되지 않으면 경고가 기록된다
- 설정 값이 0이면 연결 누출 감지 기능이 비활성화된다
- **기본값** : 0

8. `pool-name`

- 커넥션 풀의 이름을 지정
- 이 이름은 주로 디버깅 및 모니터링에서 사용
- **기본값** : HikariPool-<자동 증가 번호>